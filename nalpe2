using Eplan.EplApi.ApplicationFramework;
using System.Windows.Forms;

namespace EplanMacroInsert
{
    public class AddInModule : IEplAddIn
    {
        public bool OnInit()
        {
            try
            {
                // Execute macro insertion
                InsertMacro macroInserter = new InsertMacro();
                macroInserter.InsertWindowMacro();

                MessageBox.Show("Macro insertion executed successfully!");
            }
            catch (System.Exception ex)
            {
                MessageBox.Show($"Error during add-in initialization: {ex.Message}");
            }

            return true;
        }

        public bool OnExit()
        {
            MessageBox.Show("Add-in exited.");
            return true;
        }

        public bool OnInitGui()
        {
            return true;
        }

        // Corrected method signature for registration
        public void OnRegister(ref bool register)
        {
            register = true;  // Ensure the add-in is registered
            MessageBox.Show("Add-in registered.");
        }

        // Corrected method signature for unregistration
        public void OnUnregister()
        {
            MessageBox.Show("Add-in unregistered.");
        }
    }
}
