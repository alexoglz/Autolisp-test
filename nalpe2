using Eplan.EplApi.ApplicationFramework;
using System.Windows.Forms;

namespace EplanMacroInsert
{
    public class AddInModule : IEplAddIn
    {
        // Initialize the add-in module when loaded
        public bool OnInit()
        {
            try
            {
                // Execute macro insertion
                InsertMacro macroInserter = new InsertMacro();
                macroInserter.InsertWindowMacro();

                MessageBox.Show("Macro insertion executed successfully!");
            }
            catch (System.Exception ex)
            {
                MessageBox.Show($"Error during add-in initialization: {ex.Message}");
            }

            return true;
        }

        // Handle add-in exit
        public bool OnExit()
        {
            MessageBox.Show("Add-in exited.");
            return true;
        }

        // Handle GUI initialization (optional, no action required here)
        public bool OnInitGui()
        {
            return true;
        }

        // Handle add-in registration with no return type
        public void OnRegister(ref bool register)
        {
            MessageBox.Show("Add-in registered.");
            register = true;  // Ensure the add-in is registered
        }

        // Handle add-in unregistration with no return type
        public void OnUnregister(ref bool unregister)
        {
            MessageBox.Show("Add-in unregistered.");
            unregister = true;  // Allow the unregistration process to complete
        }
    }
}
