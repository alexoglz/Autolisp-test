using Eplan.EplApi.ApplicationFramework;
using System.Windows.Forms;

namespace EplanMacroInsert
{
    public class AddInModule : IEplAddIn
    {
        // Initialize add-in module when loaded
        public bool OnInit()
        {
            try
            {
                // Directly call the InsertMacro method to run it at initialization
                InsertMacro macroInserter = new InsertMacro();
                macroInserter.InsertWindowMacro();

                MessageBox.Show("Macro insertion executed successfully!");
            }
            catch (System.Exception ex)
            {
                MessageBox.Show($"Error during add-in initialization: {ex.Message}");
            }

            return true;
        }

        // Unload resources if necessary
        public bool OnExit()
        {
            MessageBox.Show("Add-in exited.");
            return true;
        }

        public bool OnInitGui()
        {
            return true;
        }
    }
}
