using Eplan.EplApi.ApplicationFramework;
using System.Windows.Forms;

namespace EplanMacroInsert
{
    public class AddInModule : IEplAddIn
    {
        public bool OnInit()
        {
            try
            {
                // Execute macro insertion
                InsertMacro macroInserter = new InsertMacro();
                macroInserter.InsertWindowMacro();

                MessageBox.Show("Macro insertion executed successfully!");
            }
            catch (System.Exception ex)
            {
                MessageBox.Show($"Error during add-in initialization: {ex.Message}");
            }

            return true;
        }

        public bool OnExit()
        {
            MessageBox.Show("Add-in exited.");
            return true;
        }

        public bool OnInitGui()
        {
            return true;
        }

        // Corrected method signature for registration
        public bool OnRegister(ref bool bLoadOnStart)
        {
            bLoadOnStart = true;  // Ensure the add-in is registered and loaded on start
            MessageBox.Show("Add-in registered.");
            return true;
        }

        // Corrected method signature for unregistration
        public bool OnUnregister()
        {
            MessageBox.Show("Add-in unregistered.");
            return true;
        }
    }
}
