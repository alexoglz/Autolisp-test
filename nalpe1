using Eplan.EplApi.Base;
using Eplan.EplApi.DataModel;
using Eplan.EplApi.HEServices;
using System.Windows.Forms;

namespace EplanMacroInsert
{
    public class InsertMacro
    {
        public void InsertMacroAtCoordinates()
        {
            try
            {
                // Initialize EPLAN project manager
                ProjectManager projectManager = new ProjectManager();

                // Get the active project
                Project currentProject = projectManager.CurrentProject;

                if (currentProject == null)
                {
                    MessageBox.Show("No active project found!");
                    return;
                }

                // Define the macro and coordinates
                string macroPath = @"C:\Path\To\Macro\Test1.ema";
                double xCoord = 100.0;
                double yCoord = 50.0;

                // Instantiate the SymbolMacro object
                SymbolMacro symbolMacro = new SymbolMacro(currentProject, macroPath);

                // Insert the macro at the specified coordinates
                symbolMacro.Insert(xCoord, yCoord, MacroVariants.Variant1, PlacementRotation.ZeroDegrees);

                MessageBox.Show("Macro inserted successfully!");
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Error: {ex.Message}");
            }
        }
    }
}
