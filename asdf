The engineer shall ensure the compatible version of AutoCAD is installed (validate that AutoCAD LT 2024 is compatible).

The engineer shall download the AutoLISP routine and determine the appropriate save location.

The engineer shall save the AutoCAD drawings, AutoLISP routine, and Master Excel file in the same folder.

If it is the first time the FORMATBOM routine is used, the engineer shall open the AutoCAD BOM drawing, navigate to "Manage" in the tool palette, click "Load Application," then "Startup Suite," then "Contents," and then "Add." The engineer shall locate the FORMATBOM routine, click "Open," and then close "Load Applications."

Task 1: Update Item Data in Existing Layer

The engineer shall open the Master Excel file, ensuring they are working with the correct revision.

In the Index, the engineer shall locate the relevant layer's corresponding worksheet and click the hyperlink.

If the layer name does not exist in the Index, the engineer shall locate the name of the layer in the AutoCAD BOM drawing, add the layer name and its page location to the Index list, and save the document.

The engineer shall update the relevant information of the part and save the document.

The engineer shall open the AutoCAD BOM relevant to the update.

The engineer shall ensure the DataLink path is correct.

Process 2: Add an Item to an Existing Layer

2.1. The engineer shall open the Excel F&ID BOM and identify the relevant layer to update by right-clicking the lower left corner of the tab list (location shown in the image below). This will bring up a list of all tabs in the Excel file.

2.2. The engineer shall add the new item information into the corresponding tab in the Excel file.

2.3. The engineer shall save the Excel document.

2.4. The engineer shall open the AutoCAD F&ID document corresponding to the modified tab.

2.5. The engineer shall type the “EXTERNAL REFERENCES” command in AutoCAD.

2.6. The engineer shall click the file reference corresponding to the layer to be updated, ensuring the saved path corresponds to the latest revision. Then close "EXTERNAL REFERENCES."

2.7. The engineer shall open the Data Link Manager with the "DATALINK" command.

2.8. The engineer shall right-click the corresponding layer and then click "Edit."

2.9. The engineer shall click "Link to range" and type the new table range that includes the added component.

2.10. The engineer shall click "Preview" and visually check that the item was updated, then click "OK."

2.11. The engineer shall verify that the Data Link is updated by opening “EXTERNAL REFERENCES,” right-clicking the relevant Data Link, and clicking “Update Data Links.”

2.12. The engineer shall ensure all tables to be located on the right side of the document are positioned to the right of the top margin number 6 (location for reference shown below).

2.13. The engineer shall save the AutoCAD document.

2.14. The engineer shall run the “FORMAT BOM” command. Text height, column and row size, and table positioning should be done automatically.
